{"version":3,"sources":["assets/Script/OcJsCall.js"],"names":["cc","Class","extends","Component","properties","recordLabel","Label","isRecording","onLoad","console","log","toString","sys","isNative","os","OS_IOS","Object","getOwnPropertyNames","_name","id","play","record","JsCallBackFromOC","addobs","jsb","reflection","callStaticMethod","oncallback","cmd","content","onDestroy","removeobs","Publisher","observers","prototype","observer","flag","i","length","push","splice","notice"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,qBAAaL,GAAGM,KADR;AAERC,qBAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZQ,KAHP;;AAkBL;AACA;AACA;AACAC,YAAQ,kBAAY;AAChBC,gBAAQC,GAAR,CAAY,eAAc,KAAKC,QAAL,EAA1B;AACAF,gBAAQC,GAAR,CAAYV,GAAGY,GAAH,CAAOC,QAAnB;AACAJ,gBAAQC,GAAR,CAAYV,GAAGY,GAAH,CAAOE,EAAnB;AACAL,gBAAQC,GAAR,CAAYV,GAAGY,GAAH,CAAOG,MAAnB;AACAN,gBAAQC,GAAR,CAAYM,OAAOC,mBAAP,CAA2B,IAA3B,CAAZ;AACAR,gBAAQC,GAAR,CAAYM,OAAOC,mBAAP,CAA2B,IAA3B,EAAiCC,KAA7C;AACAT,gBAAQC,GAAR,CAAYM,OAAOC,mBAAP,CAA2B,IAA3B,EAAiCE,EAA7C;AACA;AACA,YAAInB,GAAGY,GAAH,CAAOC,QAAP,IAAmBb,GAAGY,GAAH,CAAOE,EAAP,IAAad,GAAGY,GAAH,CAAOG,MAA3C,EAAmD;;AAE/CN,oBAAQC,GAAR,CAAY,kBAAZ;AACH;AACJ,KAlCI;;AAoCLU,UAAM,gBAAY;AACd,YAAIpB,GAAGY,GAAH,CAAOC,QAAP,IAAmBb,GAAGY,GAAH,CAAOE,EAAP,IAAad,GAAGY,GAAH,CAAOG,MAA3C,EAAmD,CAElD;AACJ,KAxCI;;AA0CLM,YAAQ,kBAAY;AAChB,YAAIrB,GAAGY,GAAH,CAAOC,QAAP,IAAmBb,GAAGY,GAAH,CAAOE,EAAP,KAAcd,GAAGY,GAAH,CAAOG,MAA5C,EAAoD;AACnD,gBAAG,CAAC,KAAKR,WAAT,EAAqB;AACjB,qBAAKA,WAAL,GAAiB,IAAjB;AACAP,mBAAGsB,gBAAH,CAAoBC,MAApB,CAA2B,IAA3B;AACGC,oBAAIC,UAAJ,CAAeC,gBAAf,CAAgC,eAAhC,EAAiD,aAAjD;AACAjB,wBAAQC,GAAR,CAAY,iBAAZ;AACN,aALD,MAOA;AACI;AACEc,oBAAIC,UAAJ,CAAeC,gBAAf,CAAgC,eAAhC,EAAiD,YAAjD;AACAjB,wBAAQC,GAAR,CAAY,mBAAZ;AACF;AACJ;AACJ,KAzDI;AA0DLiB,gBAAW,oBAASC,GAAT,EAAaC,OAAb,EAAqB;AAC/B,YAAG,CAAC,KAAKtB,WAAT,EAAsB;AACtB;AACIE,wBAAQC,GAAR,CAAY,YAAZ;AACH,aAHD,MAIA;AACI,iBAAKH,WAAL,GAAiB,KAAjB;AACAE,oBAAQC,GAAR,CAAY,8BAA4BkB,GAA5B,GAAiC,WAAjC,GAA6CC,OAAzD;AACH;AACDpB,gBAAQC,GAAR,CAAY,wCAAZ,EAAsDkB,GAAtD,EAA2DC,OAA3D;AACA,KApEI;AAqELC,eAAW,qBACX;AACI9B,WAAGsB,gBAAH,CAAoBS,SAApB,CAA8B,IAA9B;AACAtB,gBAAQC,GAAR,CAAY,sCAAZ;AACAD,gBAAQC,GAAR,CAAY,sBAAZ;AACH;AA1EI,CAAT;;AA+EA,SAASsB,SAAT,GAAqB;AACjB,SAAKC,SAAL,GAAe,EAAf;AACH;AACDD,UAAUE,SAAV,CAAoBX,MAApB,GAA2B,UAASY,QAAT,EAAkB;;AAEzC,QAAIC,OAAO,KAAX;AACA,SAAK,IAAIC,IAAI,KAAKJ,SAAL,CAAeK,MAAf,GAAwB,CAArC,EAAwCD,KAAK,CAA7C,EAAgDA,GAAhD,EAAqD;AACjD,YAAG,KAAKJ,SAAL,CAAeI,CAAf,MAAoBF,QAAvB,EAAgC;AAC5BC,mBAAK,IAAL;AACH;AACJ;AACD,QAAG,CAACA,IAAJ,EAAS;AACL,aAAKH,SAAL,CAAeM,IAAf,CAAoBJ,QAApB;AACH;AACD,WAAO,IAAP;AACH,CAZD;;AAcAH,UAAUE,SAAV,CAAoBH,SAApB,GAA8B,UAASI,QAAT,EAAkB;AAC5C,QAAIF,YAAY,KAAKA,SAArB;AACA,SAAK,IAAII,IAAI,CAAb,EAAgBA,IAAIJ,UAAUK,MAA9B,EAAsCD,GAAtC,EAA2C;AACvC,YAAGJ,UAAUI,CAAV,MAAeF,QAAlB,EAA2B;AACvBF,sBAAUO,MAAV,CAAiBH,CAAjB,EAAmB,CAAnB;AACH;AACJ;AACD,WAAO,IAAP;AACH,CARD;;AAUAL,UAAUE,SAAV,CAAoBO,MAApB,GAA2B,UAASb,GAAT,EAAaC,OAAb,EAAqB;AAC5CpB,YAAQC,GAAR,CAAY,kBAAZ;AACAD,YAAQC,GAAR,CAAY,iCAA+B,KAAKuB,SAAL,CAAeK,MAA1D;AACA,QAAIL,YAAY,KAAKA,SAArB;AACA,SAAK,IAAII,IAAI,CAAb,EAAgBA,IAAIJ,UAAUK,MAA9B,EAAsCD,GAAtC,EAA2C;AACvCJ,kBAAUI,CAAV,EAAaV,UAAb,CAAwBC,GAAxB,EAA4BC,OAA5B;AACH;AACJ,CAPD;;AASA7B,GAAGsB,gBAAH,GAAoB,IAAIU,SAAJ,EAApB","file":"unknown","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        recordLabel: cc.Label,\n        isRecording: false\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n    // },\n    onLoad: function () {\n        console.log(\"ljj Debug \"+ this.toString());\n        console.log(cc.sys.isNative);\n        console.log(cc.sys.os);\n        console.log(cc.sys.OS_IOS);\n        console.log(Object.getOwnPropertyNames(this));\n        console.log(Object.getOwnPropertyNames(this)._name);\n        console.log(Object.getOwnPropertyNames(this).id);\n        //console.log(Object.getOwnPropertyNames(this).getDescription());\n        if (cc.sys.isNative && cc.sys.os == cc.sys.OS_IOS) {\n      \n            console.log('onLoad is called');\n        }\n    },\n\n    play: function () {\n        if (cc.sys.isNative && cc.sys.os == cc.sys.OS_IOS) {\n\n        }\n    },\n\t\t\n    record: function () {\n        if (cc.sys.isNative && cc.sys.os === cc.sys.OS_IOS) {\n        \tif(!this.isRecording){\n        \t    this.isRecording=true;\n        \t    cc.JsCallBackFromOC.addobs(this);\n                jsb.reflection.callStaticMethod('AudioRecorder', 'startRecord');\n                console.log('Start recording');\n        \t}\n        \telse\n        \t{\n        \t    //this.isRecording=false;\n          \t    jsb.reflection.callStaticMethod('AudioRecorder', 'manualStop');\n          \t    console.log('Stoping recording');\n            }\n        }\n    },\n    oncallback:function(cmd,content){\n    \tif(!this.isRecording) //by manually stoped\n    \t{\n    \t    console.log(\"Do Nothing\")\n    \t}else\n    \t{\n    \t    this.isRecording=false;\n    \t    console.log(\"Data is process done cmd=\"+cmd+ \" content=\"+content );\n    \t}\n    \tconsole.log(\"Called in js:RecordDoneCallBack(%s,%s)\", cmd, content);\n    },\n    onDestroy: function()\n    {\n        cc.JsCallBackFromOC.removeobs(this);\n        console.log(\"Removed self from the observers list\")\n        console.log(\"OC JS CALL Destroyed\");\n    }\n});\n\n\n\nfunction Publisher (){\n    this.observers=[];\n}\nPublisher.prototype.addobs=function(observer){\n    \n    var flag = false;\n    for (var i = this.observers.length - 1; i >= 0; i--) {\n        if(this.observers[i]===observer){\n            flag=true;                \n        }\n    }\n    if(!flag){\n        this.observers.push(observer);\n    }\n    return this;\n};\n\nPublisher.prototype.removeobs=function(observer){\n    var observers = this.observers;\n    for (var i = 0; i < observers.length; i++) {\n        if(observers[i]===observer){\n            observers.splice(i,1);\n        }\n    }\n    return this;\n}\n\nPublisher.prototype.notice=function(cmd,content){\n    console.log(\"Notice is gotten\");\n    console.log(\"Now the observers' count is \"+this.observers.length);\n    var observers = this.observers;\n    for (var i = 0; i < observers.length; i++) {\n        observers[i].oncallback(cmd,content);\n    }\n}\n\ncc.JsCallBackFromOC=new Publisher();"]}